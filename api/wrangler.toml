# ==========================================
# CMS Site API - Cloudflare Worker
# ==========================================

name = "cms-site-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Ambiente de produção
[env.production]
vars = { ENVIRONMENT = "production" }

# Bindings
[[d1_databases]]
binding = "DB"
database_name = "cms-site-db"
database_id = "8961e5db-b486-4bc5-bf35-be81240be063"

[[r2_buckets]]
binding = "MEDIA"
bucket_name = "cms-site-media"

[[kv_namespaces]]
binding = "CACHE"
id = "bcdc2b754e8049d38da38f0e004c7104"

[[kv_namespaces]]
binding = "SESSIONS"
id = "1e35f7e79bc645d09441f6200efb0183"

# Workers AI
[ai]
binding = "AI"

# Cloudflare Images - Para transformação e otimização de imagens
[images]
binding = "IMAGES"

# Durable Objects (opcional - para coordenação de cache)
# Descomentar quando precisar de Durable Objects
# [[durable_objects.bindings]]
# name = "CACHE_COORDINATOR"
# class_name = "CacheCoordinator"

# [[durable_objects.bindings]]
# name = "WRITE_SERIALIZER"
# class_name = "WriteSerializer"

# [durable_objects]
# [[durable_objects.migrations]]
# tag = "v1"
# new_classes = ["CacheCoordinator", "WriteSerializer"]

# Queues (opcional - para processamento assíncrono)
# Descomentar quando precisar de Queues
# [[queues.producers]]
# queue = "cms-tasks"
# binding = "TASKS_QUEUE"

# [[queues.consumers]]
# queue = "cms-tasks"
# max_batch_size = 10
# max_batch_timeout = 30

# Variáveis de ambiente (definir no dashboard ou via wrangler secret)
[vars]
ADMIN_ORIGIN = "https://cms-site-admin.pages.dev"
SITE_ORIGIN = "https://cms-site.pages.dev"

# Secrets (configurar via: wrangler secret put JWT_SECRET)
# JWT_SECRET = "seu-secret-aqui"
