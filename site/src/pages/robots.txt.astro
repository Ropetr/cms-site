---
/**
 * Robots.txt dinâmico
 */

const API_URL = import.meta.env.PUBLIC_API_URL || 'https://cms-site-api.planacacabamentos.workers.dev';

let settings: any = {};

try {
  const res = await fetch(`${API_URL}/api/public/settings`);
  if (res.ok) settings = (await res.json()).data || {};
} catch (error) {
  console.error('Error fetching settings:', error);
}

const siteUrl = settings.site_url || 'https://cms-site.pages.dev';

const robotsContent = `# Robots.txt - ${settings.site_name || 'CMS Site'}
# Gerado automaticamente

User-agent: *
Allow: /

# Bloquear áreas administrativas
Disallow: /admin/
Disallow: /api/
Disallow: /_astro/

# Sitemap
Sitemap: ${siteUrl}/sitemap.xml

# Crawl-delay (opcional)
Crawl-delay: 1
`.trim();
---
{robotsContent}
