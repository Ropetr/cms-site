---
/**
 * Robots.txt dinâmico
 */
import { getSettings } from '../lib/api';

const siteId = Astro.locals.siteId;
const siteDomain = Astro.locals.siteDomain;

let settings: any = {};

try {
  settings = await getSettings(siteId) || {};
} catch (error) {
  console.error('Error fetching settings:', error);
}

const siteUrl = settings.site_url || `https://${siteDomain}`;

const robotsContent = `# Robots.txt - ${settings.site_name || 'CMS Site'}
# Gerado automaticamente

User-agent: *
Allow: /

# Bloquear áreas administrativas
Disallow: /admin/
Disallow: /api/
Disallow: /_astro/

# Sitemap
Sitemap: ${siteUrl}/sitemap.xml

# Crawl-delay (opcional)
Crawl-delay: 1
`.trim();
---
{robotsContent}
